# My system configuration
Please let me know if you see anything dubious or that can be improved.
## How it works

On new systems, start with `home-manager`.

Start with opening a nix shell here:

```sh
nix-shell
```

Make sure your `NIX_PATH` is set before continuing.

For `home-manager`, I symlink ~/.config/home-manager/home.nix to, for example,
`home-manager/thelxinoe/home.nix` and run:
```sh
nix-shell '<home-manager>' -A install
```

Restart the shell; your `NIX_PATH` should now be setup such that everything
"just works"L

```sh
sudo --preserve-env nixos-rebuild switch
```

As long as you just update the config file without the pins, you can
just use `home-manager switch`. If you want to update everything, then
you need to run

```sh
niv update
```

Followed by the same commands as above.

## Updating System Version

1. change the `nixpkgs` pin
2. update ./system/modules/boot.nix `system.stateVersion` accordingly
3. switch to the new config

## Just show me your vim/emacs config

Vim: config/nvim/lua/*.lua (*)
Emacs: config/init.el

(*) My `init.lua` file is generated by nix as a require to all files under that directory. See `neovim.nix` for details.

NOTE that the emacs config might need some tweaking, since it's designed
to run under `nix`.

## Structure

I am in the process of cleaning this up. Meanwhile:

The `shell.nix` exists such that I can run the commands at the top of this
file using the pinned `nixpkgs`/`home-manager` versions.

- `config` has mostly raw config files; some are no longer used
- `dev-shell` is some idea I am trying out for having a single dev shell per language, or at least a starting point; extremely early/unfleshed
- `home-manager` is the home-manager config
  - `modules` is where all the gory details are
  - `aiode` is my laptop
  - `fractal` is my home server/nas
  - `thelxinoe` is my main desktop
- `nix` is the `niv` pins
- `system` is the system config
  - `modules` is where all the gory details are
  - `aiode` is my laptop
  - `fractal` is my home server/nas
  - `thelxinoe` is my main desktop

## TODO
- [ ] flakify home-manager and remove niv? :/
    - [ ] neovim
    - [ ] warnings
    - [ ] test it
    - [ ] do I stick to unstable or?
    - [ ] (opt) separate bigger packages into separate flakes (e.g. neovim/emacs at least)
    - [ ] maybe setup vscode too?
    - [ ] do I still need a direnv/shell nix?
- [ ] 3rd monitor + monitor setup at boot
- [ ] xmonad
    - [ ] sound buttons (change source)
    - [ ] listen (web)server for commands
- [ ] review/update emacs things
